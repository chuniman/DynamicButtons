{"version":3,"sources":["webpack:///webpack/bootstrap","webpack:///./src/index.js","webpack:///./src/models.js","webpack:///./src/routes.js","webpack:///external \"body-parser\"","webpack:///external \"cors\"","webpack:///external \"ejs\"","webpack:///external \"express\"","webpack:///external \"mongoose\"","webpack:///external \"mongoose-double\"","webpack:///external \"multer\"","webpack:///external \"request\""],"names":["express","require","mongoose","routes","cors","ejs","app","set","__dirname","engine","renderFile","use","static","connect","listen","console","log","ObjectId","Schema","Types","SchemaTypes","ButtonSchema","ubicacion","String","stream","status","type","default","Y","Double","X","MapaSchema","route","Button","model","Mapa","module","exports","bodyParser","jsonParser","json","request","multer","storage","diskStorage","destination","req","file","cb","filename","originalname","upload","models","post","res","body","save","get","cams","find","cam","params","delete","findOneAndDelete","patch","findOneAndUpdate","itBe","error","response","statusCode","mapa","findOne","sort","field","_id","limit","single","render"],"mappings":"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","file":"main.js","sourcesContent":[" \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId]) {\n \t\t\treturn installedModules[moduleId].exports;\n \t\t}\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\ti: moduleId,\n \t\t\tl: false,\n \t\t\texports: {}\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.l = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// define getter function for harmony exports\n \t__webpack_require__.d = function(exports, name, getter) {\n \t\tif(!__webpack_require__.o(exports, name)) {\n \t\t\tObject.defineProperty(exports, name, { enumerable: true, get: getter });\n \t\t}\n \t};\n\n \t// define __esModule on exports\n \t__webpack_require__.r = function(exports) {\n \t\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n \t\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n \t\t}\n \t\tObject.defineProperty(exports, '__esModule', { value: true });\n \t};\n\n \t// create a fake namespace object\n \t// mode & 1: value is a module id, require it\n \t// mode & 2: merge all properties of value into the ns\n \t// mode & 4: return value when already ns object\n \t// mode & 8|1: behave like require\n \t__webpack_require__.t = function(value, mode) {\n \t\tif(mode & 1) value = __webpack_require__(value);\n \t\tif(mode & 8) return value;\n \t\tif((mode & 4) && typeof value === 'object' && value && value.__esModule) return value;\n \t\tvar ns = Object.create(null);\n \t\t__webpack_require__.r(ns);\n \t\tObject.defineProperty(ns, 'default', { enumerable: true, value: value });\n \t\tif(mode & 2 && typeof value != 'string') for(var key in value) __webpack_require__.d(ns, key, function(key) { return value[key]; }.bind(null, key));\n \t\treturn ns;\n \t};\n\n \t// getDefaultExport function for compatibility with non-harmony modules\n \t__webpack_require__.n = function(module) {\n \t\tvar getter = module && module.__esModule ?\n \t\t\tfunction getDefault() { return module['default']; } :\n \t\t\tfunction getModuleExports() { return module; };\n \t\t__webpack_require__.d(getter, 'a', getter);\n \t\treturn getter;\n \t};\n\n \t// Object.prototype.hasOwnProperty.call\n \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"/\";\n\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(__webpack_require__.s = 0);\n","const express = require('express');\r\nconst mongoose = require('mongoose');\r\nconst routes = require('./routes');\r\nconst cors = require('cors')\r\nconst ejs = require('ejs');\r\nconst app = express();\r\n\r\n// //setear para que puedas usar ejs\r\n// app.set('view engine', 'ejs');\r\n\r\n// set the default views folder\r\napp.set('views', __dirname + '/views');\r\napp.engine('html', require('ejs').renderFile);\r\n\r\n\r\napp.use(express.static(__dirname + '/public'));\r\n\r\nmongoose.connect('mongodb://localhost/cameras');\r\n\r\napp.use(cors())\r\nroutes(app);\r\n\r\napp.listen(3000, () => console.log('Servidor corriendo en el puerto 3000!'));","const mongoose = require(\"mongoose\");\r\nrequire(\"mongoose-double\")(mongoose);\r\nconst ObjectId = mongoose.Schema.Types.ObjectId;\r\n\r\nvar SchemaTypes = mongoose.Schema.Types;\r\n\r\nconst ButtonSchema = new mongoose.Schema({\r\n  ubicacion: String,\r\n  stream: String,\r\n  status: { type: String, default: \"success\" },\r\n  Y: {\r\n    type: SchemaTypes.Double\r\n  },\r\n  X: {\r\n    type: SchemaTypes.Double\r\n  }\r\n});\r\n\r\nconst MapaSchema = new mongoose.Schema({\r\n  route: String\r\n});\r\n\r\nconst Button = mongoose.model(\"Button\", ButtonSchema);\r\n\r\nconst Mapa = mongoose.model(\"Mapa\", MapaSchema);\r\n\r\nmodule.exports = {\r\n  Button: Button,\r\n  Mapa: Mapa,\r\n};\r\n","const bodyParser = require(\"body-parser\");\r\nconst jsonParser = bodyParser.json();\r\nconst request = require(\"request\");\r\nconst multer = require(\"multer\");\r\n\r\nconst storage = multer.diskStorage({\r\n  destination: function(req, file, cb) {\r\n    cb(null, \"./src/public/img/\");\r\n  },\r\n  filename: function(req, file, cb) {\r\n    cb(null, file.originalname);\r\n  }\r\n});\r\n\r\nconst upload = multer({ storage: storage });\r\nconst models = require(\"./models\");\r\n\r\nmodule.exports = app => {\r\n  //insert usuarios\r\n  app.post(\"/Buttons\", jsonParser, async (req, res) => {\r\n    const Button = await new models.Button(req.body).save();\r\n\r\n    res.json(Button);\r\n  });\r\n\r\n  //get all Buttons\r\n  app.get(\"/Buttons\", async (req, res) => {\r\n    const cams = await models.Button.find({});\r\n\r\n    res.json(cams);\r\n  });\r\n\r\n  //get Button from ubicacion\r\n  app.get(\"/Buttons/:ubicacion\", async (req, res) => {\r\n    const cam = await models.Button.find({ ubicacion: req.params.ubicacion });\r\n\r\n    res.json(cam);\r\n  });\r\n\r\n  //delete Button from ubicacion\r\n  app.delete(\"/Buttons/:ubicacion\", async (req, res) => {\r\n    const cam = await models.Button.findOneAndDelete({\r\n      ubicacion: req.params.ubicacion\r\n    });\r\n    res.json(cam.ubicacion);\r\n  });\r\n\r\n  //cambiar el status de una camara\r\n  app.patch(\"/Buttons/:ubicacion\", jsonParser, async (req, res) => {\r\n    const cam = await models.Button.findOneAndUpdate(\r\n      { ubicacion: req.params.ubicacion },\r\n      { status: req.body.status }\r\n    );\r\n    res.json(\"listo\");\r\n  });\r\n\r\n  //obtain Buttons status, igual devuelvo camaras pero aca las saco de otro lugar\r\n  app.get(\"/status\", async (req, res) => {\r\n    let itBe = await request(\r\n      \"http://localhost:3000/Buttons\",\r\n      { json: true },\r\n      function(error, response, body) {\r\n        if (!error && response.statusCode == 200) {\r\n          res.json(body);\r\n        }\r\n      }\r\n    );\r\n  });\r\n\r\n  //te devuelve el ultimo mapa\r\n  app.get(\"/mapa\", jsonParser, async (req, res) => {\r\n    const mapa = await models.Mapa.findOne()\r\n      .sort({ field: \"asc\", _id: -1 })\r\n      .limit(1);\r\n    res.json(mapa);\r\n  });\r\n\r\n  // guarda la imagen en una carpeta y la ruta en la bd\r\n  app.post(\"/addMap\", upload.single(\"productImage\"), async (req, res) => {\r\n    const mapa = await new models.Mapa({ route: req.file.originalname }).save();\r\n    res.render(\"addMap.html\");\r\n  });\r\n\r\n  //renders\r\n  //no fue la mejor idea dejarle de nombre de ruta map, pero no sabia que iba a terminar guardando rutas de mapas\r\n  app.get(\"/map\", async (req, res) => {\r\n    res.render(\"map.html\");\r\n  });\r\n\r\n  app.get(\"/addButton\", async (req, res) => {\r\n    res.render(\"addButton.html\");\r\n  });\r\n\r\n  app.get(\"/deleteButton\", async (req, res) => {\r\n    res.render(\"deleteButton.html\");\r\n  });\r\n\r\n  app.get(\"/addMap\", async (req, res) => {\r\n    res.render(\"addMap.html\");\r\n  });\r\n};\r\n","module.exports = require(\"body-parser\");","module.exports = require(\"cors\");","module.exports = require(\"ejs\");","module.exports = require(\"express\");","module.exports = require(\"mongoose\");","module.exports = require(\"mongoose-double\");","module.exports = require(\"multer\");","module.exports = require(\"request\");"],"sourceRoot":""}