{"version":3,"sources":["webpack:///webpack/bootstrap","webpack:///./src/index.js","webpack:///./src/models.js","webpack:///./src/routes.js","webpack:///external \"body-parser\"","webpack:///external \"cors\"","webpack:///external \"ejs\"","webpack:///external \"express\"","webpack:///external \"mongoose\"","webpack:///external \"mongoose-double\"","webpack:///external \"multer\"","webpack:///external \"request\""],"names":["express","require","mongoose","routes","cors","app","set","__dirname","engine","renderFile","use","static","connect","listen","console","log","ObjectId","Schema","Types","SchemaTypes","ButtonsSchema","ubicacion","String","stream","status","type","default","Y","Double","X","MapaSchema","route","Buttons","model","Mapa","module","exports","bodyParser","jsonParser","json","request","multer","storage","diskStorage","destination","req","file","cb","filename","originalname","upload","models","post","res","Button","Camera","body","save","camera","get","cams","find","cam","params","delete","findOneAndDelete","patch","findOneAndUpdate","itBe","error","response","statusCode","single","path","mapa","findOne","sort","field","_id","limit","render"],"mappings":"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","file":"main.js","sourcesContent":[" \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId]) {\n \t\t\treturn installedModules[moduleId].exports;\n \t\t}\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\ti: moduleId,\n \t\t\tl: false,\n \t\t\texports: {}\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.l = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// define getter function for harmony exports\n \t__webpack_require__.d = function(exports, name, getter) {\n \t\tif(!__webpack_require__.o(exports, name)) {\n \t\t\tObject.defineProperty(exports, name, { enumerable: true, get: getter });\n \t\t}\n \t};\n\n \t// define __esModule on exports\n \t__webpack_require__.r = function(exports) {\n \t\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n \t\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n \t\t}\n \t\tObject.defineProperty(exports, '__esModule', { value: true });\n \t};\n\n \t// create a fake namespace object\n \t// mode & 1: value is a module id, require it\n \t// mode & 2: merge all properties of value into the ns\n \t// mode & 4: return value when already ns object\n \t// mode & 8|1: behave like require\n \t__webpack_require__.t = function(value, mode) {\n \t\tif(mode & 1) value = __webpack_require__(value);\n \t\tif(mode & 8) return value;\n \t\tif((mode & 4) && typeof value === 'object' && value && value.__esModule) return value;\n \t\tvar ns = Object.create(null);\n \t\t__webpack_require__.r(ns);\n \t\tObject.defineProperty(ns, 'default', { enumerable: true, value: value });\n \t\tif(mode & 2 && typeof value != 'string') for(var key in value) __webpack_require__.d(ns, key, function(key) { return value[key]; }.bind(null, key));\n \t\treturn ns;\n \t};\n\n \t// getDefaultExport function for compatibility with non-harmony modules\n \t__webpack_require__.n = function(module) {\n \t\tvar getter = module && module.__esModule ?\n \t\t\tfunction getDefault() { return module['default']; } :\n \t\t\tfunction getModuleExports() { return module; };\n \t\t__webpack_require__.d(getter, 'a', getter);\n \t\treturn getter;\n \t};\n\n \t// Object.prototype.hasOwnProperty.call\n \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"/\";\n\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(__webpack_require__.s = 0);\n","const express = require('express');\r\nconst mongoose = require('mongoose');\r\nconst routes = require('./routes');\r\nconst cors = require('cors')\r\nconst app = express();\r\n\r\n\r\n// set the default views folder\r\napp.set('views', __dirname + '/views');\r\napp.engine('html', require('ejs').renderFile);\r\n\r\napp.use(express.static(__dirname + '/public'));\r\n\r\nmongoose.connect('mongodb://localhost/cameras');\r\n\r\napp.use(cors())\r\nroutes(app);\r\n\r\napp.listen(3000, () => console.log('Servidor corriendo en el puerto 3000!'));","const mongoose = require(\"mongoose\");\r\nrequire(\"mongoose-double\")(mongoose);\r\nconst ObjectId = mongoose.Schema.Types.ObjectId;\r\n\r\nvar SchemaTypes = mongoose.Schema.Types;\r\n\r\nconst ButtonsSchema = new mongoose.Schema({\r\n  ubicacion: String,\r\n  stream: String,\r\n  status: { type: String, default: \"success\" },\r\n  Y: {\r\n    type: SchemaTypes.Double\r\n  },\r\n  X: {\r\n    type: SchemaTypes.Double\r\n  }\r\n});\r\n\r\nconst MapaSchema = new mongoose.Schema({\r\n  route: String\r\n});\r\n\r\nconst Buttons = mongoose.model(\"Buttons\", ButtonsSchema);\r\n\r\nconst Mapa = mongoose.model(\"Mapa\", MapaSchema);\r\n\r\nmodule.exports = {\r\n  Buttons: Buttons,\r\n  Mapa: Mapa,\r\n};\r\n","const bodyParser = require(\"body-parser\");\r\nconst jsonParser = bodyParser.json();\r\nconst request = require(\"request\");\r\nconst multer = require(\"multer\");\r\n\r\nconst storage = multer.diskStorage({\r\n  destination: function (req,file,cb) {\r\n//    cb(null,'./uploads/');\r\n    cb(null,'./src/public/img/');    \r\n    \r\n  },\r\n  filename: function (req,file,cb) {\r\n    cb(null,file.originalname);\r\n    \r\n  }\r\n});\r\n\r\nconst upload = multer({ storage: storage });\r\nconst models = require(\"./models\");\r\n\r\nmodule.exports = app => {\r\n  //insert usuarios\r\n  app.post(\"/Buttons\", jsonParser, async (req, res) => {\r\n    const Button = await new models.Camera(req.body).save();\r\n\r\n    res.json(camera);\r\n  });\r\n\r\n  //get all cameras\r\n  app.get(\"/Buttons\", async (req, res) => {\r\n    const cams = await models.Camera.find({});\r\n\r\n    res.json(cams);\r\n  });\r\n\r\n  //get camera from ubicacion\r\n  app.get(\"/Buttons/:ubicacion\", async (req, res) => {\r\n    const cam = await models.Camera.find({ ubicacion: req.params.ubicacion });\r\n\r\n    res.json(cam);\r\n  });\r\n\r\n  //delete camera from ubicacion\r\n  app.delete(\"/Buttons/:ubicacion\", async (req, res) => {\r\n    const cam = await models.Camera.findOneAndDelete({\r\n      ubicacion: req.params.ubicacion\r\n    });\r\n    res.json(cam.ubicacion);\r\n  });\r\n\r\n  //cambiar el status de una camara\r\n  app.patch(\"/Buttons/:ubicacion\", jsonParser, async (req, res) => {\r\n    const cam = await models.Camera.findOneAndUpdate(\r\n      { ubicacion: req.params.ubicacion },\r\n      { status: req.body.status }\r\n    );\r\n    res.json(\"listo\");\r\n  });\r\n\r\n  //obtain cameras status, igual devuelvo camaras pero aca las saco de otro lugar\r\n  app.get(\"/status\", async (req, res) => {\r\n    let itBe = await request(\r\n      \"http://localhost:3000/Buttons\",\r\n      { json: true },\r\n      function(error, response, body) {\r\n        if (!error && response.statusCode == 200) {\r\n          //console.log(body);\r\n          res.json(body);\r\n        }\r\n      }\r\n    );\r\n  });\r\n\r\n  //guardar ruta del mapa\r\n  app.post(\"/mapa\", upload.single('productImage'), async (req, res) => {\r\n    console.log(req.file.path);\r\n    const mapa = await new models.Mapa(req.file.originalname).save();\r\n    res.json('listo');\r\n  });\r\n\r\n  //te devuelve el ultimo mapa\r\n  app.get(\"/mapa\", jsonParser, async (req, res) => {\r\n    const mapa = await models.Mapa.findOne()\r\n      .sort({ field: \"asc\", _id: -1 })\r\n      .limit(1);\r\n    res.json(mapa);\r\n  });\r\n\r\n  //probar subir imagenes\r\n  app.post(\"/imagenes\", upload.single('productImage'), async (req, res) => {\r\n    console.log(req.file.originalname);\r\n    const mapa = await new models.Mapa({route:req.file.originalname}).save();\r\n    res.json('listo');\r\n  });\r\n\r\n  //renders\r\n  //no fue la mejor idea dejarle de nombre de ruta map, pero no sabia que iba a terminar guardando rutas de mapas\r\n  app.get(\"/map\", async (req, res) => {\r\n    res.render(\"map.html\");\r\n  });\r\n\r\n  app.get(\"/addButton\", async (req, res) => {\r\n    res.render(\"addButton.html\");\r\n  });\r\n\r\n  app.get(\"/deleteButton\", async (req, res) => {\r\n    res.render(\"deleteButton.html\");\r\n  });\r\n\r\n  app.get(\"/addMap\", async (req, res) => {\r\n    res.render(\"addMap.html\");\r\n  });\r\n};\r\n","module.exports = require(\"body-parser\");","module.exports = require(\"cors\");","module.exports = require(\"ejs\");","module.exports = require(\"express\");","module.exports = require(\"mongoose\");","module.exports = require(\"mongoose-double\");","module.exports = require(\"multer\");","module.exports = require(\"request\");"],"sourceRoot":""}